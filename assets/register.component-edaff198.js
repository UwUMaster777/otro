import{q as b,_ as w,u as x,s as k,l as y,r as n,o as i,c as m,a as d,t as c,f as t,m as D,b as u,v as M,F as B,p as N}from"./index-23a2f24f.js";import{v as C}from"./account-data-validator.service-9dc1a38d.js";const a={no_mail:"No has ingresado un correo válido",no_password:"No has ingresado una contraseña válida",no_at:"El correo no posee una @",more_than_one_at:"El correo tiene más @ de las que debería",no_mail_valid_url:"La direccion web del correo es invalida",email_already_used:"El correo ya ha sido usado antes",no_repeated_password:"Las contraseñas ingresadas no son iguales"};async function U(r,e){if(!r.login.password)return a.no_password;if(!r.login.email)return a.no_mail;if(r.login.password!==e)return a.no_repeated_password;const l=r.login.email.split("@");if(l.length>2)return a.more_than_one_at;if(l.length!==2||!l[0]||!l[1])return a.no_at;const p=l[1].split(".");if(p.length<2)return a.no_mail_valid_url;for(let s in p)if(p[s].length===0)return a.no_mail_valid_url;return await b(r.login.email)?a.email_already_used:!1}const E={data(){return{registerData:x,errorMessage:"",completedPhases:[!1,!1],completedPercentage:0,repeatedPassword:"",progressBarMode:"determinate",genres:k}},methods:{indeterminateProgressbar(){this.progressBarMode="indeterminate"},determinateProgressbar(){this.progressBarMode="determinate"},tryContinue(){let r=0;for(;r<this.completedPhases.length&&this.completedPhases[r];r++);switch(this.indeterminateProgressbar(),r){case 0:U(this.registerData,this.repeatedPassword).then(e=>{this.errorMessage=e,this.errorMessage||(this.completedPhases[r]=!0),this.determinateProgressbar(),this.updateProgress()});break;case 1:C(this.registerData).then(e=>{this.errorMessage=e,this.errorMessage||(this.completedPhases[r]=!0),this.determinateProgressbar(),this.updateProgress()});break}},updateProgress(){let r=0;for(let e=0;e<this.completedPhases.length;e++)this.completedPhases[e]&&r++;this.completedPercentage=r*100/this.completedPhases.length,r===this.completedPhases.length&&(this.indeterminateProgressbar(),y.methods.register(this.registerData).then(e=>{console.log(e),this.$emit("register_success")}).catch(e=>{this.tryBack(),console.log(e),this.$emit("register_error",e)}))},tryBack(){for(let r=this.completedPhases.length-1;0<=r;r--)if(this.completedPhases[r]){this.completedPhases[r]=!1;break}this.updateProgress()}},watch:{"registerData.personal.genre":{handle(r,e){console.log(this.registerData.personal.genre)},immediate:!0}}},L={class:"margin-2 flex flex-col align-center"},R={class:"text-10 margin-1"},q={class:"flex align-center flex-col"},z={key:0,class:"flex flex-col login gap-1"},A={class:"p-error text",id:"text-error"},F={key:1,class:"flex flex-col login gap-1"},S={class:"p-error text",id:"text-error"},T={key:2,class:"flex flex-row login gap-2",style:{"padding-top":"0.5rem"}};function j(r,e,l,p,s,h){const v=n("pv-progress-bar"),g=n("pv-input-text"),_=n("pv-password"),P=n("pv-input-number"),V=n("pv-dropdown"),f=n("pv-button");return i(),m(B,null,[d("div",L,[d("div",R,c(s.completedPercentage===100?"Registrando...":"Regístrate"),1),t(v,{value:s.completedPercentage,style:{width:"24rem"},mode:s.progressBarMode},{default:D(()=>[N("   ")]),_:1},8,["value","mode"])]),d("div",q,[s.completedPhases[0]===!1?(i(),m("div",z,[t(g,{modelValue:s.registerData.login.email,"onUpdate:modelValue":e[0]||(e[0]=o=>s.registerData.login.email=o),placeholder:"correo"},null,8,["modelValue"]),t(_,{modelValue:s.registerData.login.password,"onUpdate:modelValue":e[1]||(e[1]=o=>s.registerData.login.password=o),placeholder:"contraseña",toggleMask:"",feedback:!1},null,8,["modelValue"]),t(_,{modelValue:s.repeatedPassword,"onUpdate:modelValue":e[2]||(e[2]=o=>s.repeatedPassword=o),placeholder:"repita la contraseña",toggleMask:"",feedback:!1},null,8,["modelValue"]),d("small",A,c(s.errorMessage||" "),1)])):s.completedPhases[1]===!1?(i(),m("div",F,[t(g,{modelValue:s.registerData.personal.firstName,"onUpdate:modelValue":e[3]||(e[3]=o=>s.registerData.personal.firstName=o),placeholder:"nombres"},null,8,["modelValue"]),t(g,{modelValue:s.registerData.personal.lastName,"onUpdate:modelValue":e[4]||(e[4]=o=>s.registerData.personal.lastName=o),placeholder:"apellidos"},null,8,["modelValue"]),t(P,{modelValue:s.registerData.personal.phone,"onUpdate:modelValue":e[5]||(e[5]=o=>s.registerData.personal.phone=o),inputMode:"numeric",mode:"decimal",min:9e8,max:999999999,placeholder:"telefono","use-grouping":!1},null,8,["modelValue"]),t(V,{modelValue:s.registerData.personal.genre,"onUpdate:modelValue":e[6]||(e[6]=o=>s.registerData.personal.genre=o),options:s.genres,optionLabel:"name","option-value":"value",placeholder:"Elija su sexo"},null,8,["modelValue","options"]),d("small",S,c(s.errorMessage||" "),1)])):u("",!0),s.completedPercentage<100?(i(),m("div",T,[s.completedPercentage!==0?(i(),M(f,{key:0,label:"Volver",size:"large",severity:"secondary",outlined:"",rounded:"",onClick:h.tryBack},null,8,["onClick"])):u("",!0),t(f,{label:"Continuar",size:"large",severity:"secondary",rounded:"",onClick:h.tryContinue},null,8,["onClick"])])):u("",!0)])],64)}const W=w(E,[["render",j]]);export{W as default};
